<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no" />
  <title>stak.call</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100;200;300;400;500&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#050507;
      --glass: rgba(255,255,255,.06);
      --border: rgba(255,255,255,.12);
      --text: rgba(255,255,255,.92);
      --dim: rgba(255,255,255,.55);
      --accent:#ffffff;
      --danger:#ff3b3b;
      --ok:#39ff88;
    }
    *{box-sizing:border-box;margin:0;padding:0;font-family:Inter,system-ui,-apple-system,Segoe UI,Roboto,Arial;}
    body{background:var(--bg); color:var(--text); height:100vh; overflow:hidden;}
    canvas{position:fixed; inset:0; z-index:-1; pointer-events:none;}
    .wrap{height:100vh; display:flex; align-items:center; justify-content:center; padding:24px;}
    .card{
      width:min(980px, 100%);
      border:1px solid var(--border);
      background:var(--glass);
      backdrop-filter: blur(22px);
      border-radius:28px;
      padding:34px;
      box-shadow:0 30px 120px rgba(0,0,0,.55);
    }
    .top{
      display:flex; justify-content:space-between; align-items:center; gap:16px;
      border-bottom:1px solid rgba(255,255,255,.08);
      padding-bottom:20px; margin-bottom:22px;
    }
    .brand{
      display:flex; flex-direction:column; gap:6px;
    }
    .brand h1{
      font-weight:200; letter-spacing:10px; font-size:26px;
      text-transform:lowercase;
    }
    .brand p{color:var(--dim); font-size:12px; letter-spacing:2px; text-transform:uppercase;}
    .pill{
      display:flex; align-items:center; gap:10px;
      padding:10px 14px; border:1px solid rgba(255,255,255,.10);
      border-radius:999px; color:var(--dim); font-size:12px;
    }
    .dot{width:8px;height:8px;border-radius:99px;background:var(--ok); box-shadow:0 0 18px rgba(57,255,136,.55);}
    .grid{
      display:grid; grid-template-columns: 1.1fr .9fr; gap:22px;
    }
    .panel{
      border:1px solid rgba(255,255,255,.10);
      background: rgba(0,0,0,.18);
      border-radius:22px;
      padding:20px;
    }
    .panel h2{
      font-weight:300; letter-spacing:4px; font-size:14px;
      text-transform:uppercase; margin-bottom:14px; color:rgba(255,255,255,.80);
    }
    .row{display:flex; gap:10px; align-items:center; margin-top:12px;}
    .input{
      width:100%;
      background:transparent;
      border:1px solid rgba(255,255,255,.12);
      border-radius:14px;
      padding:14px 14px;
      color:var(--text);
      outline:none;
      font-size:14px;
    }
    .input:focus{border-color: rgba(255,255,255,.32);}
    .btn{
      border:1px solid rgba(255,255,255,.75);
      background:transparent;
      color:var(--text);
      padding:14px 16px;
      border-radius:14px;
      cursor:pointer;
      letter-spacing:3px;
      text-transform:uppercase;
      font-size:11px;
      transition:.25s ease;
      white-space:nowrap;
    }
    .btn:hover{background:var(--accent); color:#000; box-shadow:0 0 30px rgba(255,255,255,.18);}
    .btn.secondary{border-color: rgba(255,255,255,.12); color:var(--dim);}
    .btn.danger{border-color: rgba(255,59,59,.75); color: rgba(255,59,59,.95);}
    .muted{color:var(--dim); font-size:12px; line-height:1.6;}
    .links{display:flex; gap:10px; flex-wrap:wrap; margin-top:14px;}
    .link{
      display:inline-flex; align-items:center; gap:10px;
      padding:12px 14px;
      border-radius:14px;
      border:1px solid rgba(255,255,255,.10);
      background: rgba(255,255,255,.03);
      color:var(--text);
      text-decoration:none;
      font-size:13px;
      transition:.2s ease;
    }
    .link:hover{border-color: rgba(255,255,255,.28);}
    .k{font-size:11px; color:var(--dim); letter-spacing:2px; text-transform:uppercase;}
    .split{
      display:grid; grid-template-columns: 1fr 1fr;
      gap:12px;
    }

    @media (max-width: 860px){
      .grid{grid-template-columns:1fr;}
      .brand h1{letter-spacing:8px;}
      .card{padding:22px;}
      .split{grid-template-columns:1fr;}
    }
  </style>
</head>
<body>
  <canvas id="stars"></canvas>

  <div class="wrap">
    <div class="card">
      <div class="top">
        <div class="brand">
          <h1>stak.call</h1>
          <p>корпоративные видеовстречи • admin console • audit</p>
        </div>
        <div class="pill"><span class="dot"></span><span id="statusText">ready</span></div>
      </div>

      <div class="grid">
        <div class="panel">
          <h2>Запуск системы</h2>
          <div class="muted">
            GitHub Pages показывает витрину. Реальный сервис (видео/чат/админка) работает на твоём backend в Render.
          </div>

          <div class="row" style="margin-top:16px">
            <input class="input" id="backendUrl" placeholder="Backend URL (пример: https://stak-call.onrender.com)" />
            <button class="btn secondary" id="saveBtn">Save</button>
          </div>

          <div class="links">
            <a class="link" id="openApp" href="#"><span class="k">Open</span><span>Войти в систему</span></a>
            <a class="link" id="openAdmin" href="#"><span class="k">Admin</span><span>Админ-панель</span></a>
          </div>

          <div class="muted" style="margin-top:12px">
            Подсказка: если Render “уснул”, первая загрузка может занять 10–30 секунд.
          </div>
        </div>

        <div class="panel">
          <h2>Быстрые проверки</h2>
          <div class="split">
            <button class="btn" id="pingBtn">Ping /health</button>
            <button class="btn danger" id="clearBtn">Reset URL</button>
          </div>
          <div class="muted" id="pingOut" style="margin-top:14px">—</div>

          <div class="muted" style="margin-top:14px">
            <div class="k" style="margin-bottom:8px">Куда ведут кнопки</div>
            <div>• Войти: <span id="showApp" class="k"></span></div>
            <div>• Админка: <span id="showAdmin" class="k"></span></div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  // ---------- settings ----------
  const LS_KEY = "stak_backend_url";

  function normalizeUrl(u){
    u = (u || "").trim();
    if(!u) return "";
    if(u.endsWith("/")) u = u.slice(0,-1);
    return u;
  }

  function setTargets(){
    const base = normalizeUrl(localStorage.getItem(LS_KEY) || "");
    const app = base ? (base + "/") : "#";
    const admin = base ? (base + "/admin") : "#";
    document.getElementById("openApp").href = app;
    document.getElementById("openAdmin").href = admin;
    document.getElementById("showApp").textContent = app === "#" ? "—" : app;
    document.getElementById("showAdmin").textContent = admin === "#" ? "—" : admin;
    document.getElementById("statusText").textContent = base ? "backend linked" : "set backend url";
  }

  const input = document.getElementById("backendUrl");
  input.value = localStorage.getItem(LS_KEY) || "";

  document.getElementById("saveBtn").onclick = () => {
    const v = normalizeUrl(input.value);
    if(!v) return alert("Укажи Backend URL");
    localStorage.setItem(LS_KEY, v);
    setTargets();
  };

  document.getElementById("clearBtn").onclick = () => {
    localStorage.removeItem(LS_KEY);
    input.value = "";
    setTargets();
    document.getElementById("pingOut").textContent = "—";
  };

  document.getElementById("pingBtn").onclick = async () => {
    const base = normalizeUrl(localStorage.getItem(LS_KEY) || "");
    if(!base) return alert("Сначала укажи Backend URL и нажми Save");
    const out = document.getElementById("pingOut");
    out.textContent = "Проверяю...";
    try{
      const r = await fetch(base + "/health", {cache:"no-store"});
      const t = await r.text();
      out.textContent = r.ok ? ("OK: " + t) : ("ERR " + r.status + ": " + t);
    }catch(e){
      out.textContent = "Нет ответа (возможен sleep или неверный URL)";
    }
  };

  setTargets();

  // ---------- stars ----------
  const canvas = document.getElementById('stars');
  const ctx = canvas.getContext('2d');
  let stars = [];
  function initStars(){
    canvas.width = innerWidth; canvas.height = innerHeight;
    stars = Array(220).fill(0).map(()=>({
      x: Math.random()*canvas.width,
      y: Math.random()*canvas.height,
      z: Math.random()*canvas.width,
      o: Math.random()
    }));
  }
  function draw(){
    ctx.clearRect(0,0,canvas.width,canvas.height);
    for(const s of stars){
      const x = (s.x - canvas.width/2) * (canvas.width/s.z) + canvas.width/2;
      const y = (s.y - canvas.height/2) * (canvas.width/s.z) + canvas.height/2;
      const size = (1 - s.z/canvas.width) * 2.2;
      ctx.fillStyle = `rgba(255,255,255,${s.o*(1 - s.z/canvas.width)})`;
      ctx.beginPath(); ctx.arc(x,y,Math.max(.2,size),0,Math.PI*2); ctx.fill();
      s.z -= 0.65;
      if(s.z <= 1) s.z = canvas.width;
    }
    requestAnimationFrame(draw);
  }
  addEventListener('resize', initStars);
  initStars(); draw();
</script>
</body>
</html>
